<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Детали автомобиля | Miniwan Store</title>
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">
    <style>
        /* Основные стили как на главной */
        body {
            margin: 0;
            padding: 0;
            background-color: #231A16;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cg stroke='%23E8DCC5' stroke-opacity='0.12' stroke-width='1' fill='none'%3E%3Cpath d='M0,20 L100,20 M20,0 L20,100 M0,80 L100,80 M80,0 L80,100 M0,0 L100,100 M100,0 L0,100'/%3E%3C/g%3E%3C/svg%3E");
            background-repeat: repeat;
            background-size: 100px 100px;
            min-height: 100vh;
            color: #F0E6D2;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow-x: hidden;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        header {
            padding: 20px 0;
            position: relative;
            z-index: 10;
            background: rgba(35, 26, 22, 0.95);
            backdrop-filter: blur(10px);
        }
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #E8DCC5;
            text-decoration: none;
        }
        .header-contact {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        .phone {
            color: #D4C4A8;
            font-size: 16px;
            text-decoration: none;
        }
        .phone:hover {
            color: #E8DCC5;
        }
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            text-decoration: none;
            text-align: center;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .btn-primary {
            background: #8B5A2B;
            color: white;
        }
        .btn-primary:hover {
            background: #A06A37;
            transform: translateY(-1px);
        }
        .btn-secondary {
            background: transparent;
            color: #E8DCC5;
            border: 1px solid #8B5A2B;
        }
        .btn-secondary:hover {
            background: rgba(139, 90, 43, 0.1);
        }
        .btn-large {
            padding: 16px 32px;
            font-size: 16px;
            min-width: 200px;
        }
        /* Хлебные крошки */
        .breadcrumbs {
            padding: 20px 0;
            color: #D4C4A8;
            font-size: 14px;
        }
        .breadcrumbs a {
            color: #8B5A2B;
            text-decoration: none;
        }
        .breadcrumbs a:hover {
            color: #A06A37;
        }
        /* Основной контент */
        .car-detail-content {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 40px;
            padding: 20px 0 60px;
        }
        /* Галерея изображений */
        .gallery {
            margin-bottom: 30px;
        }
        .main-image {
            width: 100%;
            height: 400px;
            background: #5D4037;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
            position: relative;
        }
        .main-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .image-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            color: #D4C4A8;
            font-size: 1.2rem;
            height: 100%;
        }
        .thumbnails {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 10px;
        }
        .thumbnail {
            height: 80px;
            background: #5D4037;
            border-radius: 5px;
            overflow: hidden;
            cursor: pointer;
            border: 2px solid transparent;
            transition: border-color 0.3s;
        }
        .thumbnail.active {
            border-color: #8B5A2B;
        }
        .thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        /* Информация об автомобиле */
        .car-info {
            background: rgba(40, 30, 25, 0.8);
            border-radius: 10px;
            padding: 30px;
        }
        .car-title {
            font-size: 2rem;
            color: #E8DCC5;
            margin: 0 0 10px 0;
        }
        .car-subtitle {
            color: #D4C4A8;
            font-size: 1.1rem;
            margin-bottom: 25px;
        }
        .price-section {
            background: rgba(139, 90, 43, 0.2);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
        }
        .prices-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 15px;
        }
        .price-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(139, 90, 43, 0.3);
        }
        .price-label {
            color: #D4C4A8;
            font-size: 0.9rem;
        }
        .price-value {
            color: #8B5A2B;
            font-weight: bold;
            font-size: 1rem;
        }
        .deposit {
            color: #D4C4A8;
            margin-top: 10px;
            font-size: 0.9rem;
            text-align: center;
        }
        .booking-widget {
            margin-bottom: 30px;
        }
        .date-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #E8DCC5;
            font-weight: 600;
        }
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            background: rgba(35, 26, 22, 0.8);
            border: 1px solid #8B5A2B;
            border-radius: 5px;
            color: #F0E6D2;
            font-size: 14px;
            box-sizing: border-box;
        }
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #A06A37;
        }
        .total-price {
            background: rgba(139, 90, 43, 0.3);
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }
        .total-label {
            color: #D4C4A8;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        .total-amount {
            font-size: 1.5rem;
            font-weight: bold;
            color: #E8DCC5;
        }
        /* Правила аренды */
        .rental-rules {
            background: rgba(40, 30, 25, 0.8);
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
        }
        .rules-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .rule-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(139, 90, 43, 0.3);
        }
        .rule-label {
            color: #D4C4A8;
            font-size: 1rem;
        }
        .rule-value {
            color: #E8DCC5;
            font-weight: 600;
        }
        /* Детали автомобиля */
        .car-specs {
            background: rgba(40, 30, 25, 0.8);
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
        }
        .specs-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .spec-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(139, 90, 43, 0.3);
        }
        .spec-label {
            color: #D4C4A8;
            font-size: 1rem;
        }
        .spec-value {
            color: #E8DCC5;
            font-weight: 600;
        }
        /* Описание */
        .description {
            background: rgba(40, 30, 25, 0.8);
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
        }
        .description h2 {
            color: #E8DCC5;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        .description p {
            color: #D4C4A8;
            line-height: 1.6;
            margin-bottom: 15px;
        }
        /* Владелец */
        .owner-info {
            background: rgba(40, 30, 25, 0.8);
            border-radius: 10px;
            padding: 25px;
            margin-top: 30px;
        }
        .owner-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        .owner-avatar {
            width: 50px;
            height: 50px;
            background: #8B5A2B;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        .owner-name {
            color: #E8DCC5;
            font-weight: 600;
        }
        .owner-rating {
            color: #D4C4A8;
            font-size: 0.9rem;
        }
        .owner-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            text-align: center;
        }
        .stat-value {
            color: #E8DCC5;
            font-weight: bold;
            font-size: 1.1rem;
        }
        .stat-label {
            color: #D4C4A8;
            font-size: 0.8rem;
        }
        /* Похожие автомобили */
        .similar-cars {
            padding: 60px 0;
            border-top: 1px solid #443A30;
        }
        .similar-cars h2 {
            text-align: center;
            color: #E8DCC5;
            font-size: 2rem;
            margin-bottom: 40px;
        }
        .similar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
        }
        .similar-car-card {
            background: rgba(40, 30, 25, 0.8);
            border-radius: 10px;
            overflow: hidden;
            transition: transform 0.3s;
            cursor: pointer;
        }
        .similar-car-card:hover {
            transform: translateY(-5px);
        }
        .similar-car-image {
            height: 180px;
            background: #5D4037;
            overflow: hidden;
        }
        .similar-car-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .similar-car-info {
            padding: 20px;
        }
        .similar-car-title {
            color: #E8C4A8;
            margin: 0 0 10px 0;
            font-size: 1.1rem;
        }
        .similar-car-price {
            color: #8B5A2B;
            font-weight: bold;
            font-size: 1.2rem;
        }
        /* Адаптивность */
        @media (max-width: 1024px) {
            .car-detail-content {
                grid-template-columns: 1fr;
                gap: 30px;
            }
            
            .main-image {
                height: 350px;
            }
        }
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .car-title {
                font-size: 1.5rem;
            }
            
            .prices-grid {
                grid-template-columns: 1fr;
            }
            
            .date-inputs {
                grid-template-columns: 1fr;
            }
            
            .owner-stats {
                grid-template-columns: 1fr;
            }
        }
        footer {
            padding: 60px 0 20px;
            background: rgba(20, 15, 12, 0.95);
            border-top: 1px solid #443A30;
        }
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }
        .footer-section h3 {
            color: #E8DCC5;
            margin-bottom: 20px;
            font-size: 1.2rem;
        }
        .footer-section ul {
            list-style: none;
            padding: 0;
        }
        .footer-section ul li {
            margin-bottom: 10px;
        }
        .footer-section a {
            color: #D4C4A8;
            text-decoration: none;
            transition: color 0.3s;
        }
        .footer-section a:hover {
            color: #E8DCC5;
        }
        .footer-bottom {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid #443A30;
            color: #D4C4A8;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <a href="index.html" class="logo">Miniwan Store</a>
                <div class="header-contact">
                    <a href="tel:+79268237180" class="phone">+7 (926) 8237180</a>
                    <a href="catalog.html" class="btn btn-secondary">← Назад к каталогу</a>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Хлебные крошки -->
        <div class="breadcrumbs">
            <a href="index.html">Главная</a> > 
            <a href="catalog.html">Каталог</a> > 
            <span id="breadcrumbCurrent">Автомобиль</span>
        </div>
        <!-- Основной контент -->
        <div class="car-detail-content">
            <!-- Левая колонка - галерея и описание -->
            <div class="left-column">
                <!-- Галерея изображений -->
                <div class="gallery">
                    <div class="main-image" id="mainImage">
                        <div class="image-placeholder">Загрузка изображения...</div>
                    </div>
                    <div class="thumbnails" id="thumbnails">
                        <!-- Динамически заполняется через JS -->
                    </div>
                </div>
                <!-- Правила аренды -->
                <div class="rental-rules">
                    <h2>Правила аренды</h2>
                    <div class="rules-list" id="rentalRules">
                        <!-- Динамически заполняется через JS -->
                    </div>
                </div>
                <!-- Характеристики -->
                <div class="car-specs">
                    <h2>Технические характеристики</h2>
                    <div class="specs-list" id="specsList">
                        <!-- Динамически заполняется через JS -->
                    </div>
                </div>
                <!-- Описание -->
                <div class="description">
                    <h2>Описание автомобиля</h2>
                    <div id="carDescription">
                        <!-- Динамически заполняется через JS -->
                    </div>
                </div>
                <!-- Информация о владельце -->
                <div class="owner-info">
                    <div class="owner-header">
                        <div class="owner-avatar" id="ownerAvatar">ИИ</div>
                        <div>
                            <div class="owner-name" id="ownerName">Иван Иванов</div>
                            <div class="owner-rating">★ 4.8 (12 отзывов)</div>
                        </div>
                    </div>
                    <div class="owner-stats">
                        <div>
                            <div class="stat-value" id="ownerCars">5</div>
                            <div class="stat-label">автомобилей</div>
                        </div>
                        <div>
                            <div class="stat-value" id="ownerRentals">47</div>
                            <div class="stat-label">аренд</div>
                        </div>
                        <div>
                            <div class="stat-value">98%</div>
                            <div class="stat-label">положительных отзывов</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Правая колонка - бронирование -->
            <div class="right-column">
                <div class="car-info">
                    <h1 class="car-title" id="carTitle">Загрузка...</h1>
                    <div class="car-subtitle" id="carSubtitle"></div>

                    <div class="price-section">
                        <div class="prices-grid" id="pricesGrid">
                            <!-- Динамически заполняется через JS -->
                        </div>
                        <div class="deposit">Залог: <span id="carDeposit">0 ₽</span></div>
                    </div>

                    <!-- Виджет бронирования -->
                    <div class="booking-widget">
                        <h3>Забронировать автомобиль</h3>
                        
                        <div class="date-inputs">
                            <div class="form-group">
                                <label for="startDate">Дата начала</label>
                                <input type="date" id="startDate" min="">
                            </div>
                            <div class="form-group">
                                <label for="endDate">Дата окончания</label>
                                <input type="date" id="endDate" min="">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="rentalDays">Количество дней</label>
                            <input type="number" id="rentalDays" min="1" value="1" readonly>
                        </div>

                        <div class="total-price">
                            <div class="total-label">Общая стоимость</div>
                            <div class="total-amount" id="totalAmount">0 ₽</div>
                        </div>

                        <button class="btn btn-primary btn-large" onclick="proceedToBooking()" style="width: 100%;">
                            Перейти к бронированию
                        </button>
                    </div>

                    <!-- Контакты -->
                    <div class="contact-info">
                        <h3>Контакты</h3>
                        <div style="margin-top: 15px;">
                            <button class="btn btn-secondary" onclick="showLocation()" style="width: 100%;">
                                📍 Местоположение
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Похожие автомобили -->
        <section class="similar-cars">
            <h2>Похожие автомобили</h2>
            <div class="similar-grid" id="similarCars">
                <!-- Динамически заполняется через JS -->
            </div>
        </section>
    </div>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Контакты</h3>
                    <ul>
                        <li><a href="mailto:info@Miniwan.store">info@Miniwan.store</a></li>
                        <li><a href="tel:+79268237180">+7 (926) 8237180</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Правовая информация</h3>
                    <ul>
                        <li><a href="privacy-policy.html">Политика конфиденциальности</a></li>
                        <li><a href="#">Условия использования</a></li>
                        <li><a href="#">Политика cookies</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Miniwan Store. Все права защищены.</p>
            </div>
        </div>
    </footer>

    <script src="js/main.js"></script>
    <script>
        // Глобальные переменные
        let currentCar = null;
        let allCars = [];
        let currentImageIndex = 0;

        // Загрузка данных автомобиля
        async function loadCarData() {
            const urlParams = new URLSearchParams(window.location.search);
            const carId = urlParams.get('id');
            if (!carId) {
                window.location.href = 'catalog.html';
                return;
            }

            try {
                const response = await fetch('data/cars.json');
                allCars = await response.json();
                
                currentCar = allCars.find(car => car.id == carId);
                
                if (!currentCar) {
                    window.location.href = 'catalog.html';
                    return;
                }

                renderCarDetails();
                loadSimilarCars();
                setupDateInputs();
                calculateTotal();
            } catch (error) {
                console.error('Ошибка загрузки данных:', error);
                document.getElementById('carTitle').textContent = 'Ошибка загрузки данных';
            }
        }

        // Рендер деталей автомобиля
        function renderCarDetails() {
            // Основная информация
            document.getElementById('carTitle').textContent = `${currentCar.brand} ${currentCar.model}`;
            document.getElementById('breadcrumbCurrent').textContent = `${currentCar.brand} ${currentCar.model}`;
            document.getElementById('carSubtitle').textContent = `${currentCar.year} год • ${currentCar.engine} • ${getTransmissionLabel(currentCar.transmission)}`;
            document.getElementById('carDeposit').textContent = `${formatPrice(currentCar.deposit)} ₽`;

            // Цены
            renderPrices();

            // Галерея
            renderGallery();

            // Правила аренды
            renderRentalRules();

            // Характеристики
            renderSpecs();

            // Описание
            renderDescription();

            // Информация о владельце
            renderOwnerInfo();
        }

        // Рендер цен
        function renderPrices() {
            const pricesGrid = document.getElementById('pricesGrid');
            
            if (!currentCar.prices) {
                pricesGrid.innerHTML = '<div class="price-item" style="grid-column: 1 / -1; text-align: center; color: #D4C4A8;">Цены не указаны</div>';
                return;
            }

            const priceTiers = [
                { days: 1, price: currentCar.prices["1"] },
                { days: 4, price: currentCar.prices["4"] },
                { days: 7, price: currentCar.prices["7"] },
                { days: 14, price: currentCar.prices["14"] },
                { days: 21, price: currentCar.prices["21"] }
            ];

            pricesGrid.innerHTML = priceTiers.map(tier => `
                <div class="price-item">
                    <span class="price-label">от ${tier.days} суток</span>
                    <span class="price-value">${formatPrice(tier.price)} ₽/день</span>
                </div>
            `).join('');
        }

        function renderGallery() {
            const mainImage = document.getElementById('mainImage');
            const thumbnails = document.getElementById('thumbnails');

            if (currentCar.images && currentCar.images.length > 0) {
                // Главное изображение
                mainImage.innerHTML = `<img src="${currentCar.images[0]}" alt="${currentCar.brand} ${currentCar.model}" 
                    onerror="this.style.display='none'; this.nextElementSibling.style.display='flex'">`;

                // Миниатюры
                thumbnails.innerHTML = currentCar.images.map((image, index) => `
                    <div class="thumbnail ${index === 0 ? 'active' : ''}" onclick="changeMainImage(${index})">
                        <img src="${image}" alt="${currentCar.brand} ${currentCar.model} - фото ${index + 1}"
                             onerror="this.style.display='none'; this.parentElement.innerHTML='📷'">
                    </div>
                `).join('');
            } else {
                mainImage.innerHTML = '<div class="image-placeholder">Нет изображений</div>';
                thumbnails.innerHTML = '';
            }
        }

        function renderRentalRules() {
            const rentalRules = document.getElementById('rentalRules');
            
            const rules = getCarRentalRules(currentCar);

            rentalRules.innerHTML = rules.map(rule => `
                <div class="rule-item">
                    <span class="rule-label">${rule.label}</span>
                    <span class="rule-value">${rule.value}</span>
                </div>
            `).join('');
        }

        function renderSpecs() {
            const specsList = document.getElementById('specsList');
            const specs = [
                { label: 'Год выпуска', value: currentCar.year },
                { label: 'Двигатель', value: currentCar.engine },
                { label: 'Коробка передач', value: getTransmissionLabel(currentCar.transmission) },
                { label: 'Количество мест', value: `${currentCar.seats}` },
                { label: 'Тип топлива', value: currentCar.fuelType },
                { label: 'Количество дверей', value: `${currentCar.doors || '4'}` },
                { label: 'Цвет', value: currentCar.color || 'Белый' },
                { label: 'Тип кузова', value: currentCar.bodyType || 'Минивэн' }
            ];

            specsList.innerHTML = specs.map(spec => `
                <div class="spec-item">
                    <span class="spec-label">${spec.label}</span>
                    <span class="spec-value">${spec.value}</span>
                </div>
            `).join('');
        }

        function changeMainImage(index) {
            const mainImage = document.getElementById('mainImage');
            const thumbnails = document.querySelectorAll('.thumbnail');
            
            // Обновляем главное изображение
            mainImage.innerHTML = `<img src="${currentCar.images[index]}" alt="${currentCar.brand} ${currentCar.model}">`;
            
            // Обновляем активную миниатюру
            thumbnails.forEach((thumb, i) => {
                thumb.classList.toggle('active', i === index);
            });
            
            currentImageIndex = index;
        }

        function renderDescription() {
            const description = document.getElementById('carDescription');
            description.innerHTML = `
                <p>${currentCar.description || 'Комфортабельный минивэн в отличном техническом состоянии. Идеально подходит для семейных поездок, путешествий с друзьями или деловых поездок.'}</p>
                <p>Автомобиль регулярно проходит техническое обслуживание и полностью готов к эксплуатации. Чистый салон, исправная техника, все документы в порядке.</p>
                <p><strong>Условия аренды:</strong> минимальный срок аренды - 1 день, залог возвращается при возврате автомобиля в исходном состоянии.</p>
            `;
        }

        function renderOwnerInfo() {
            // В реальном приложении эти данные должны приходить из базы
            document.getElementById('ownerName').textContent = currentCar.owner?.name || 'Алексей Петров';
            document.getElementById('ownerAvatar').textContent = getInitials(currentCar.owner?.name || 'Алексей Петров');
            document.getElementById('ownerCars').textContent = currentCar.owner?.carsCount || '3';
            document.getElementById('ownerRentals').textContent = currentCar.owner?.rentalsCount || '24';
        }

        function getInitials(name) {
            return name.split(' ').map(word => word[0]).join('').toUpperCase();
        }

        function getTransmissionLabel(transmission) {
            return transmission === 'automatic' ? 'Автоматическая' : 'Механическая';
        }

        // Похожие автомобили
        function loadSimilarCars() {
            const similarCars = allCars
                .filter(car => car.id != currentCar.id && car.brand === currentCar.brand)
                .slice(0, 3);

            const similarGrid = document.getElementById('similarCars');
            
            if (similarCars.length === 0) {
                similarGrid.innerHTML = '<p style="text-align: center; color: #D4C4A8; grid-column: 1 / -1;">Нет похожих автомобилей</p>';
                return;
            }

            similarGrid.innerHTML = similarCars.map(car => `
                <div class="similar-car-card" onclick="window.location.href='car-detail.html?id=${car.id}'">
                    <div class="similar-car-image">
                        <img src="${car.images[0]}" alt="${car.brand} ${car.model}"
                             onerror="this.style.display='none'; this.parentElement.innerHTML='<div style=\\'display: flex; align-items: center; justify-content: center; height: 100%; color: #D4C4A8;\\'>${car.brand} ${car.model}</div>'">
                    </div>
                    <div class="similar-car-info">
                        <h3 class="similar-car-title">${car.brand} ${car.model}</h3>
                        <div class="similar-car-price">${formatPrice(car.prices["1"])} ₽/день</div>
                    </div>
                </div>
            `).join('');
        }

        // Бронирование
        function setupDateInputs() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('startDate').min = today;
            document.getElementById('endDate').min = today;

            document.getElementById('startDate').addEventListener('change', updateEndDateMin);
            document.getElementById('endDate').addEventListener('change', calculateRentalDays);
        }

        function updateEndDateMin() {
            const startDate = document.getElementById('startDate').value;
            if (startDate) {
                document.getElementById('endDate').min = startDate;
                document.getElementById('endDate').value = '';
                calculateRentalDays();
            }
        }

        function calculateRentalDays() {
            const startDate = new Date(document.getElementById('startDate').value);
            const endDate = new Date(document.getElementById('endDate').value);
            
            if (startDate && endDate && endDate >= startDate) {
                const days = Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24)) + 1;
                document.getElementById('rentalDays').value = days;
                calculateTotal();
            } else {
                document.getElementById('rentalDays').value = 1;
                calculateTotal();
            }
        }

        function calculateTotal() {
            const days = parseInt(document.getElementById('rentalDays').value) || 1;
            const pricePerDay = getCarPrice(currentCar, days);
            const total = pricePerDay * days;
            document.getElementById('totalAmount').textContent = `${formatPrice(total)} ₽`;
        }

        function proceedToBooking() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            
            if (!startDate || !endDate) {
                alert('Пожалуйста, выберите даты аренды');
                return;
            }

            window.location.href = `booking.html?carId=${currentCar.id}&startDate=${startDate}&endDate=${endDate}`;
        }

        function showLocation() {
            alert('Карта с местоположением автомобиля будет показана здесь');
        }

        // Загрузка данных при загрузке страницы
        document.addEventListener('DOMContentLoaded', loadCarData);
    </script>
</body>
</html>